<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard de Contenido</title>
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; margin:0; background:#0b0b0c; color:#f2f2f2; }
    .wrap { max-width: 1160px; margin: 0 auto; padding: 24px; }
    h1 { font-size: 26px; margin: 0 0 14px; }

    .grid { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:12px; }
    .card { border:1px solid #2a2a2a; border-radius:12px; padding:16px; background:#101012; }
    .label { font-size:12px; opacity:.7; }
    .num { font-size:34px; font-weight:800; margin-top:6px; }

    .row { display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; align-items:center; }
    input { background:#121214; border:1px solid #2a2a2a; color:#fff; padding:10px 12px; border-radius:10px; min-width: 260px; }
    .btn { cursor:pointer; user-select:none; padding:10px 12px; border-radius:10px; border:1px solid #2a2a2a; background:#121214; color:#fff; }
    .btn.active { border-color:#6b6bff; }

    .list { margin-top:14px; border:1px solid #2a2a2a; border-radius:12px; overflow:hidden; background:#101012; }
    .item { display:flex; justify-content:space-between; gap:12px; padding:12px 14px; border-top:1px solid #2a2a2a; cursor:pointer; }
    .item:first-child { border-top:none; }
    .item:hover { background:#121214; }
    .title { font-weight:700; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width: 720px; }
    .meta { font-size:12px; opacity:.75; margin-top:4px; }
    .chip { display:inline-block; font-size:11px; padding:4px 8px; border-radius:999px; border:1px solid #2a2a2a; background:#121214; opacity:.95; }

    a { color:#9aa0ff; text-decoration:none; font-size:12px; }
    .right { text-align:right; white-space:nowrap; display:flex; flex-direction:column; gap:6px; align-items:flex-end; }
    .muted { opacity:.7; margin-top:10px; font-size:12px; }

    /* Calendario */
    .calTitle { margin-top: 22px; font-size: 16px; font-weight: 800; }
    .calSub { margin-top: 6px; font-size: 12px; opacity: .75; }
    .cal { margin-top:12px; display:grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap:10px; }
    .day { border:1px solid #2a2a2a; border-radius:12px; background:#101012; padding:10px; min-height:110px; }
    .day h3 { margin:0 0 8px; font-size:12px; opacity:.75; font-weight:600; }
    .ev { font-size:12px; padding:6px 8px; border-radius:10px; border:1px solid #2a2a2a; background:#121214; margin-bottom:8px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; cursor:pointer; }
    .ev:hover { border-color:#6b6bff; }

    /* Modal */
    .modalBg { position:fixed; inset:0; background: rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; padding:16px; z-index: 999; }
    .modal { width:min(1100px, 100%); max-height: 88vh; overflow:auto; border:1px solid #2a2a2a; border-radius:16px; background:#0f0f12; }
    .modalHead { display:flex; justify-content:space-between; gap:12px; padding:14px 16px; border-bottom:1px solid #2a2a2a; position: sticky; top:0; background:#0f0f12; align-items:center; flex-wrap:wrap; }
    .modalHead h2 { margin:0; font-size:16px; font-weight:800; }
    .x { cursor:pointer; border:1px solid #2a2a2a; background:#121214; color:#fff; border-radius:10px; padding:8px 10px; }
    .modalBody { padding: 14px 16px 18px; }

    .kv { display:grid; grid-template-columns: 180px 1fr; gap:10px; margin-top:10px; }
    .k { font-size:12px; opacity:.7; }
    .v { font-size:13px; line-height:1.35; }
    .box { margin-top:12px; border:1px solid #2a2a2a; background:#101012; border-radius:12px; padding:12px; }
    pre { margin:0; white-space:pre-wrap; word-break:break-word; font-size:12px; opacity:.92; }

    .tabRow { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    iframe { width:100%; height:72vh; border:1px solid #2a2a2a; border-radius:12px; background:#0b0b0c; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>üìÖ Dashboard de Contenido</h1>

    <div class="grid">
      <div class="card">
        <div class="label">Total</div>
        <div class="num" id="total">‚Äî</div>
      </div>
      <div class="card">
        <div class="label">‚è≥ Por crear (estado: generado)</div>
        <div class="num" id="porCrear">‚Äî</div>
      </div>
      <div class="card">
        <div class="label">‚úÖ Listo</div>
        <div class="num" id="listo">‚Äî</div>
      </div>
      <div class="card">
        <div class="label">üóìÔ∏è Con fecha de publicaci√≥n</div>
        <div class="num" id="enCal">‚Äî</div>
      </div>
    </div>

    <div class="row">
      <input id="q" placeholder="Buscar por t√≠tulo / problema..." />
      <button class="btn active" id="tabPorCrear">Por crear</button>
      <button class="btn" id="tabListo">Listo</button>
      <button class="btn" id="tabTodos">Todos</button>
      <button class="btn" id="refresh">‚Üª Recargar</button>
    </div>

    <div class="list" id="list"></div>
    <div class="muted" id="foot"></div>

    <div class="calTitle">üóìÔ∏è Calendario de publicaciones</div>
    <div class="calSub" id="calSub"></div>
    <div id="calendarWrap"></div>
  </div>

  <div class="modalBg" id="modalBg">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modalHead">
        <div style="min-width:0; flex:1;">
          <h2 id="mTitle">Detalle</h2>
        </div>

        <div class="tabRow">
          <button class="btn active" id="mTabDetalle">Detalle</button>
          <button class="btn" id="mTabNotion">Notion</button>
          <button class="x" id="mClose">Cerrar ‚úï</button>
        </div>
      </div>

      <div class="modalBody">
        <div id="panelDetalle">
          <div class="kv">
            <div class="k">Estado</div><div class="v" id="mEstado"></div>
            <div class="k">Problema</div><div class="v" id="mProblema"></div>
            <div class="k">Creado</div><div class="v" id="mCreado"></div>
            <div class="k">Publicaci√≥n</div><div class="v" id="mPub"></div>
            <div class="k">Acci√≥n</div><div class="v" id="mAccion"></div>
            <div class="k">Links</div><div class="v" id="mLinks"></div>
          </div>

          <div class="box">
            <div class="k">Script / Guion</div>
            <div class="v" id="mScript" style="margin-top:6px; opacity:.9;"></div>
          </div>

          <div class="box">
            <div class="k">JSON completo</div>
            <pre id="mJson"></pre>
          </div>
        </div>

        <div id="panelNotion" style="display:none;">
          <div class="box" style="margin-top:0;">
            <div class="k">Vista Notion (si queda en blanco, Notion bloque√≥ el embed)</div>
            <div style="margin-top:10px;">
              <iframe id="notionFrame" loading="lazy"></iframe>
            </div>
            <div class="muted" style="margin-top:10px;">
              Si no carga, us√° el link "Notion" del panel Detalle para abrirlo.
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

<script>
  const ITEMS = [{"id":"28e4630b-a135-8177-8e38-e6ed7f900c22","name":"Te respondemos sin compromiso, ¬°consult√° tu iPhone ideal!","url":"https://www.notion.so/Te-respondemos-sin-compromiso-consult-tu-iPhone-ideal-28e4630ba13581778e38e6ed7f900c22","property_problema_relacionado":"No conozco esa tienda","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-16T18:39:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG1_oRsqRM/FLkPYOz73OWtpQGfJ94yRg/edit?utm_content=DAG1_oRsqRM&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Te respondemos sin compromiso, ¬°consult√° tu iPhone ideal!"},{"id":"28e4630b-a135-8178-8c55-f39a8264d942","name":"Eleg√≠ tu iPhone hoy, con garant√≠a y confianza total","url":"https://www.notion.so/Eleg-tu-iPhone-hoy-con-garant-a-y-confianza-total-28e4630ba13581788c55f39a8264d942","property_problema_relacionado":"No conozco esa tienda","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-16T18:39:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Eleg√≠ tu iPhone hoy, con garant√≠a y confianza total"},{"id":"28e4630b-a135-8197-801e-e795dc54a513","name":"Tu iPhone ya no se actualiza. Renovalo hoy y quedate tranquilo por a√±os.","url":"https://www.notion.so/Tu-iPhone-ya-no-se-actualiza-Renovalo-hoy-y-quedate-tranquilo-por-a-os-28e4630ba1358197801ee795dc54a513","property_problema_relacionado":"Ya no actualiza iOS","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-16T15:28:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG1-36SCC8/zwaYKWHumssNQ92CwyHtxw/edit?utm_content=DAG1-36SCC8&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Tu iPhone ya no se actualiza. Renovalo hoy y quedate tranquilo por a√±os."},{"id":"28e4630b-a135-81cb-8058-c7abf4ec8807","name":"Miles ya compraron su iPhone con garant√≠a, ¬øqu√© esper√°s?","url":"https://www.notion.so/Miles-ya-compraron-su-iPhone-con-garant-a-qu-esper-s-28e4630ba13581cb8058c7abf4ec8807","property_problema_relacionado":"No conozco esa tienda","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-16T18:39:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Miles ya compraron su iPhone con garant√≠a, ¬øqu√© esper√°s?"},{"id":"28e4630b-a135-81db-984e-decc5407e4f6","name":"Segu√≠s usando un iPhone desactualizado... ¬øY si lo renov√°s sin vueltas?","url":"https://www.notion.so/Segu-s-usando-un-iPhone-desactualizado-Y-si-lo-renov-s-sin-vueltas-28e4630ba13581db984edecc5407e4f6","property_problema_relacionado":"Ya no actualiza iOS","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-16T15:28:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Segu√≠s usando un iPhone desactualizado... ¬øY si lo renov√°s sin vueltas?"},{"id":"28f4630b-a135-8120-a7c4-c2c001a743d9","name":"Tu pr√≥ximo iPhone en camino sin tr√°mites ni sorpresas, ¬øcu√°ndo arrancamos?","url":"https://www.notion.so/Tu-pr-ximo-iPhone-en-camino-sin-tr-mites-ni-sorpresas-cu-ndo-arrancamos-28f4630ba1358120a7c4c2c001a743d9","property_problema_relacionado":"Mejor espero el 15","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:14:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Tu pr√≥ximo iPhone en camino sin tr√°mites ni sorpresas, ¬øcu√°ndo arrancamos?"},{"id":"28f4630b-a135-813d-8271-f9eb7817b981","name":"Dej√° de esperar al 15: hoy mismo pod√©s tener tu iPhone sin vueltas","url":"https://www.notion.so/Dej-de-esperar-al-15-hoy-mismo-pod-s-tener-tu-iPhone-sin-vueltas-28f4630ba135813d8271f9eb7817b981","property_problema_relacionado":"Mejor espero el 15","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:14:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Dej√° de esperar al 15: hoy mismo pod√©s tener tu iPhone sin vueltas"},{"id":"28f4630b-a135-813f-b02c-fe5e90756089","name":"No esperes m√°s: pagalo en partes, disfrutalo entero desde hoy.","url":"https://www.notion.so/No-esperes-m-s-pagalo-en-partes-disfrutalo-entero-desde-hoy-28f4630ba135813fb02cfe5e90756089","property_problema_relacionado":"Es mucha guita junta","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T15:21:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2E59QLo8/WNMLVHmk5ZEZrtn9U7Ru6A/edit?utm_content=DAG2E59QLo8&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"No esperes m√°s: pagalo en partes, disfrutalo entero desde hoy."},{"id":"28f4630b-a135-8168-a52d-f541a3b15257","name":"Dej√° de renegar con tu iPhone: hoy lo entend√©s en minutos, no en horas","url":"https://www.notion.so/Dej-de-renegar-con-tu-iPhone-hoy-lo-entend-s-en-minutos-no-en-horas-28f4630ba1358168a52df541a3b15257","property_problema_relacionado":"Se me hace chino","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:33:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Dej√° de renegar con tu iPhone: hoy lo entend√©s en minutos, no en horas"},{"id":"28f4630b-a135-8171-a5f4-d51b99f9e9c4","name":"Dej√°s el cargador en casa sabiendo que no te va a fallar el iPhone.","url":"https://www.notion.so/Dej-s-el-cargador-en-casa-sabiendo-que-no-te-va-a-fallar-el-iPhone-28f4630ba1358171a5f4d51b99f9e9c4","property_problema_relacionado":"Me cag√°s con la bater√≠a","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:00:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Dej√°s el cargador en casa sabiendo que no te va a fallar el iPhone."},{"id":"28f4630b-a135-8198-9681-ffd2175db02c","name":"¬øDemasiado caro de una? Llev√°telo en cuotas sin vueltas.","url":"https://www.notion.so/Demasiado-caro-de-una-Llev-telo-en-cuotas-sin-vueltas-28f4630ba13581989681ffd2175db02c","property_problema_relacionado":"Es mucha guita junta","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T15:21:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬øDemasiado caro de una? Llev√°telo en cuotas sin vueltas."},{"id":"28f4630b-a135-819f-894d-d61221eeeca7","name":"Cheque√° esto antes de comprar un iPhone usado o pod√©s perder plata.","url":"https://www.notion.so/Cheque-esto-antes-de-comprar-un-iPhone-usado-o-pod-s-perder-plata-28f4630ba135819f894dd61221eeeca7","property_problema_relacionado":"¬øTiene Face ID trucho?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:27:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Cheque√° esto antes de comprar un iPhone usado o pod√©s perder plata."},{"id":"28f4630b-a135-81ad-a968-ec7479c3e0d7","name":"No compres un iPhone sin revisar si el Face ID es original. Te pod√©s arrepentir.","url":"https://www.notion.so/No-compres-un-iPhone-sin-revisar-si-el-Face-ID-es-original-Te-pod-s-arrepentir-28f4630ba13581ada968ec7479c3e0d7","property_problema_relacionado":"¬øTiene Face ID trucho?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:27:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"No compres un iPhone sin revisar si el Face ID es original. Te pod√©s arrepentir."},{"id":"28f4630b-a135-81b4-95b5-e3211da99dc7","name":"¬øY si lo estrenas HOY? Sin esperas, sin vueltas, sin complicaciones","url":"https://www.notion.so/Y-si-lo-estrenas-HOY-Sin-esperas-sin-vueltas-sin-complicaciones-28f4630ba13581b495b5e3211da99dc7","property_problema_relacionado":"Mejor espero el 15","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:14:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬øY si lo estrenas HOY? Sin esperas, sin vueltas, sin complicaciones"},{"id":"28f4630b-a135-81bb-870b-ff6653ac85e2","name":"¬øTu iPhone se apaga en horas? Te cambiamos la bater√≠a en el acto.","url":"https://www.notion.so/Tu-iPhone-se-apaga-en-horas-Te-cambiamos-la-bater-a-en-el-acto-28f4630ba13581bb870bff6653ac85e2","property_problema_relacionado":"Me cag√°s con la bater√≠a","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:00:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬øTu iPhone se apaga en horas? Te cambiamos la bater√≠a en el acto."},{"id":"28f4630b-a135-81c3-9e90-cb3cc8020a21","name":"Tu iPhone nuevo, pagado en cuotas y sin sangrar la billetera.","url":"https://www.notion.so/Tu-iPhone-nuevo-pagado-en-cuotas-y-sin-sangrar-la-billetera-28f4630ba13581c39e90cb3cc8020a21","property_problema_relacionado":"Es mucha guita junta","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T15:21:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Tu iPhone nuevo, pagado en cuotas y sin sangrar la billetera."},{"id":"28f4630b-a135-81cc-a339-e049ca2d56d5","name":"¬øTu iPhone te vuelve loco? ¬°Te lo explicamos bien, sin vueltas!","url":"https://www.notion.so/Tu-iPhone-te-vuelve-loco-Te-lo-explicamos-bien-sin-vueltas-28f4630ba13581cca339e049ca2d56d5","property_problema_relacionado":"Se me hace chino","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:33:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2u1PrNh0/qViEysa354NopfEYdHr9NA/edit?utm_content=DAG2u1PrNh0&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬øTu iPhone te vuelve loco? ¬°Te lo explicamos bien, sin vueltas!"},{"id":"28f4630b-a135-81db-8877-dced2f58ad10","name":"Entr√° ahora y empez√° a disfrutar tu iPhone sin complicarte m√°s","url":"https://www.notion.so/Entr-ahora-y-empez-a-disfrutar-tu-iPhone-sin-complicarte-m-s-28f4630ba13581db8877dced2f58ad10","property_problema_relacionado":"Se me hace chino","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:33:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2E59QLo8/WNMLVHmk5ZEZrtn9U7Ru6A/edit?utm_content=DAG2E59QLo8&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Entr√° ahora y empez√° a disfrutar tu iPhone sin complicarte m√°s"},{"id":"28f4630b-a135-81df-ab6a-ced0c8bdc38d","name":"Evit√° que te estafen: revis√° el Face ID antes de pagar tu iPhone.","url":"https://www.notion.so/Evit-que-te-estafen-revis-el-Face-ID-antes-de-pagar-tu-iPhone-28f4630ba13581dfab6aced0c8bdc38d","property_problema_relacionado":"¬øTiene Face ID trucho?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T17:27:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Evit√° que te estafen: revis√° el Face ID antes de pagar tu iPhone."},{"id":"2904630b-a135-8105-8f16-f28ea7005441","name":"Quer√©s iPhone y tranquilidad total? Este es el lugar","url":"https://www.notion.so/Quer-s-iPhone-y-tranquilidad-total-Este-es-el-lugar-2904630ba13581058f16f28ea7005441","property_problema_relacionado":"No me dan factura","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:45:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Quer√©s iPhone y tranquilidad total? Este es el lugar"},{"id":"2904630b-a135-8109-b506-d8b8a894e306","name":"No cambies la bater√≠a de tu iPhone sin saber esto antes","url":"https://www.notion.so/No-cambies-la-bater-a-de-tu-iPhone-sin-saber-esto-antes-2904630ba1358109b506d8b8a894e306","property_problema_relacionado":"No entiendo los ciclos de bater√≠a","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:54:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"No cambies la bater√≠a de tu iPhone sin saber esto antes"},{"id":"2904630b-a135-8125-bbc4-e185895e6bb1","name":"iPhone libre de iCloud = compra 100% segura. Garantizado y listo para usar","url":"https://www.notion.so/iPhone-libre-de-iCloud-compra-100-segura-Garantizado-y-listo-para-usar-2904630ba1358125bbc4e185895e6bb1","property_problema_relacionado":"¬øY si tiene iCloud?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T23:04:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"iPhone libre de iCloud = compra 100% segura. Garantizado y listo para usar"},{"id":"2904630b-a135-814b-9142-d3d821630892","name":"Probalo hoy sin compromiso y eleg√≠ tranquilo tu pr√≥ximo iPhone","url":"https://www.notion.so/Probalo-hoy-sin-compromiso-y-eleg-tranquilo-tu-pr-ximo-iPhone-2904630ba135814b9142d3d821630892","property_problema_relacionado":"No lo puedo probar bien","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T18:45:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Probalo hoy sin compromiso y eleg√≠ tranquilo tu pr√≥ximo iPhone"},{"id":"2904630b-a135-8165-a7f8-cb8d382882e4","name":"Sin vueltas, ni excusas: tu nuevo iPhone llega con todo en regla","url":"https://www.notion.so/Sin-vueltas-ni-excusas-tu-nuevo-iPhone-llega-con-todo-en-regla-2904630ba1358165a7f8cb8d382882e4","property_problema_relacionado":"No me dan factura","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:45:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Sin vueltas, ni excusas: tu nuevo iPhone llega con todo en regla"},{"id":"2904630b-a135-816b-96d4-e3f47fc47ea8","name":"Ahorra plata verificando si tu iPhone lo necesita realmente","url":"https://www.notion.so/Ahorra-plata-verificando-si-tu-iPhone-lo-necesita-realmente-2904630ba135816b96d4e3f47fc47ea8","property_problema_relacionado":"No entiendo los ciclos de bater√≠a","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:54:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Ahorra plata verificando si tu iPhone lo necesita realmente"},{"id":"2904630b-a135-817f-8c32-d3833a59f4f9","name":"Revis√° primero y evit√° gastar en una bater√≠a innecesaria","url":"https://www.notion.so/Revis-primero-y-evit-gastar-en-una-bater-a-innecesaria-2904630ba135817f8c32d3833a59f4f9","property_problema_relacionado":"No entiendo los ciclos de bater√≠a","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:54:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Revis√° primero y evit√° gastar en una bater√≠a innecesaria"},{"id":"2904630b-a135-8180-874f-f57dac454c66","name":"Tom√° tu decisi√≥n con confianza: probalo antes de comprar","url":"https://www.notion.so/Tom-tu-decisi-n-con-confianza-probalo-antes-de-comprar-2904630ba1358180874ff57dac454c66","property_problema_relacionado":"No lo puedo probar bien","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T18:45:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Tom√° tu decisi√≥n con confianza: probalo antes de comprar"},{"id":"2904630b-a135-818a-ae3d-e8dcc812e7c9","name":"¬øTu iPhone no rinde el d√≠a completo? Consultanos y descubr√≠ si es la bater√≠a.","url":"https://www.notion.so/Tu-iPhone-no-rinde-el-d-a-completo-Consultanos-y-descubr-si-es-la-bater-a-2904630ba135818aae3de8dcc812e7c9","property_problema_relacionado":"No entiendo los ciclos de bater√≠a","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:57:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2MDpAuwY/R9xMZuoeu8rAjso_WXd7RA/edit?utm_content=DAG2MDpAuwY&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬øTu iPhone no rinde el d√≠a completo? Consultanos y descubr√≠ si es la bater√≠a."},{"id":"2904630b-a135-8190-ad1b-efa5581deb79","name":"Despreocupate, compr√°s tu iPhone y lo us√°s al instante, sin cuentas ni bloqueos","url":"https://www.notion.so/Despreocupate-compr-s-tu-iPhone-y-lo-us-s-al-instante-sin-cuentas-ni-bloqueos-2904630ba1358190ad1befa5581deb79","property_problema_relacionado":"¬øY si tiene iCloud?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T23:04:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Despreocupate, compr√°s tu iPhone y lo us√°s al instante, sin cuentas ni bloqueos"},{"id":"2904630b-a135-81ac-8c4a-dfd7222db049","name":"Conoc√© si es el iPhone indicado para vos antes de decidirte","url":"https://www.notion.so/Conoc-si-es-el-iPhone-indicado-para-vos-antes-de-decidirte-2904630ba13581ac8c4adfd7222db049","property_problema_relacionado":"No lo puedo probar bien","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T18:45:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2G-1V1Gg/jQ-CALySSS77A-1QwvgEQg/edit?utm_content=DAG2G-1V1Gg&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Conoc√© si es el iPhone indicado para vos antes de decidirte"},{"id":"2904630b-a135-81b4-b1e1-d2d265dda9e4","name":"Compralo hoy con factura oficial y olvidate de dramas ma√±ana","url":"https://www.notion.so/Compralo-hoy-con-factura-oficial-y-olvidate-de-dramas-ma-ana-2904630ba13581b4b1e1d2d265dda9e4","property_problema_relacionado":"No me dan factura","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-18T16:45:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Compralo hoy con factura oficial y olvidate de dramas ma√±ana"},{"id":"2904630b-a135-81df-b7ea-fce0f6860814","name":"Evit√° sorpresas: todos nuestros iPhones vienen con iCloud completamente liberado","url":"https://www.notion.so/Evit-sorpresas-todos-nuestros-iPhones-vienen-con-iCloud-completamente-liberado-2904630ba13581dfb7eafce0f6860814","property_problema_relacionado":"¬øY si tiene iCloud?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-17T23:04:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Evit√° sorpresas: todos nuestros iPhones vienen con iCloud completamente liberado"},{"id":"2954630b-a135-8163-8256-e6d5c4cbda3c","name":"No tires plata: confirm√° si es nuevo de verdad antes de comprar","url":"https://www.notion.so/No-tires-plata-confirm-si-es-nuevo-de-verdad-antes-de-comprar-2954630ba13581638256e6d5c4cbda3c","property_problema_relacionado":"Me sale lo mismo nuevo afuera","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-23T18:11:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"No tires plata: confirm√° si es nuevo de verdad antes de comprar"},{"id":"2954630b-a135-8177-9315-c59c7dbd4ce4","name":"¬øVas a viajar y comprar un iPhone? Te ayudamos a no caer en fraudes","url":"https://www.notion.so/Vas-a-viajar-y-comprar-un-iPhone-Te-ayudamos-a-no-caer-en-fraudes-2954630ba13581779315c59c7dbd4ce4","property_problema_relacionado":"Me sale lo mismo nuevo afuera","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-23T18:11:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬øVas a viajar y comprar un iPhone? Te ayudamos a no caer en fraudes"},{"id":"2954630b-a135-81aa-9293-c06e37fab2b6","name":"Cheque√° tu iPhone antes de pagar y evit√° que te vendan uno reparado","url":"https://www.notion.so/Cheque-tu-iPhone-antes-de-pagar-y-evit-que-te-vendan-uno-reparado-2954630ba13581aa9293c06e37fab2b6","property_problema_relacionado":"Me sale lo mismo nuevo afuera","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-23T18:11:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2prWfMFg/RVGKaKuxPSu__IxuA-cK3w/edit?utm_content=DAG2prWfMFg&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Cheque√° tu iPhone antes de pagar y evit√° que te vendan uno reparado"},{"id":"2964630b-a135-8117-8241-dddf447f6147","name":"Hoy pod√©s tener el iPhone que quer√≠as sin pagar de m√°s","url":"https://www.notion.so/Hoy-pod-s-tener-el-iPhone-que-quer-as-sin-pagar-de-m-s-2964630ba13581178241dddf447f6147","property_problema_relacionado":"Capaz baja m√°s el d√≥lar","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:30:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Hoy pod√©s tener el iPhone que quer√≠as sin pagar de m√°s"},{"id":"2964630b-a135-814d-947d-edfc56f5e91e","name":"Evitate comprar un iPhone robado: lo chequeamos por vos en el momento","url":"https://www.notion.so/Evitate-comprar-un-iPhone-robado-lo-chequeamos-por-vos-en-el-momento-2964630ba135814d947dedfc56f5e91e","property_problema_relacionado":"¬øY si est√° reportado?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:34:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Evitate comprar un iPhone robado: lo chequeamos por vos en el momento"},{"id":"2964630b-a135-8163-9555-de1a984c5094","name":"Antes de comprar tu iPhone, te decimos si est√° limpio o bloqueado. As√≠ de simple","url":"https://www.notion.so/Antes-de-comprar-tu-iPhone-te-decimos-si-est-limpio-o-bloqueado-As-de-simple-2964630ba13581639555de1a984c5094","property_problema_relacionado":"¬øY si est√° reportado?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:34:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Antes de comprar tu iPhone, te decimos si est√° limpio o bloqueado. As√≠ de simple"},{"id":"2964630b-a135-816d-94b3-c46a437adbc7","name":"¬°Ahora tu iPhone te cuesta menos que nunca! Aprovech√° antes de que suba el d√≥lar","url":"https://www.notion.so/Ahora-tu-iPhone-te-cuesta-menos-que-nunca-Aprovech-antes-de-que-suba-el-d-lar-2964630ba135816d94b3c46a437adbc7","property_problema_relacionado":"Capaz baja m√°s el d√≥lar","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:30:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"¬°Ahora tu iPhone te cuesta menos que nunca! Aprovech√° antes de que suba el d√≥lar"},{"id":"2964630b-a135-817a-98a5-f2a923310fd7","name":"No compres otro chip sin saber si tu iPhone est√° libre","url":"https://www.notion.so/No-compres-otro-chip-sin-saber-si-tu-iPhone-est-libre-2964630ba135817a98a5f2a923310fd7","property_problema_relacionado":"Ni idea si es liberado","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:54:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"No compres otro chip sin saber si tu iPhone est√° libre"},{"id":"2964630b-a135-819c-86d2-fcba5cd33adb","name":"Chequeamos en minutos si est√° reportado: no arriesgues tu plata ni tu tranquilidad","url":"https://www.notion.so/Chequeamos-en-minutos-si-est-reportado-no-arriesgues-tu-plata-ni-tu-tranquilidad-2964630ba135819c86d2fcba5cd33adb","property_problema_relacionado":"¬øY si est√° reportado?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:34:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Chequeamos en minutos si est√° reportado: no arriesgues tu plata ni tu tranquilidad"},{"id":"2964630b-a135-81ca-82d1-f1f022923e63","name":"Revis√° ya si tu iPhone acepta cualquier compa√±√≠a, sin vueltas","url":"https://www.notion.so/Revis-ya-si-tu-iPhone-acepta-cualquier-compa-a-sin-vueltas-2964630ba13581ca82d1f1f022923e63","property_problema_relacionado":"Ni idea si es liberado","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:54:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Revis√° ya si tu iPhone acepta cualquier compa√±√≠a, sin vueltas"},{"id":"2964630b-a135-81d1-9a93-e3cfbd2a483e","name":"Descubr√≠ en minutos si tu iPhone est√° liberado o sigue bloqueado","url":"https://www.notion.so/Descubr-en-minutos-si-tu-iPhone-est-liberado-o-sigue-bloqueado-2964630ba13581d19a93e3cfbd2a483e","property_problema_relacionado":"Ni idea si es liberado","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:54:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Descubr√≠ en minutos si tu iPhone est√° liberado o sigue bloqueado"},{"id":"2964630b-a135-81fa-ade9-c3062206ea6d","name":"Con el d√≥lar m√°s bajo, tu nuevo iPhone est√° m√°s cerca de lo que pens√°s","url":"https://www.notion.so/Con-el-d-lar-m-s-bajo-tu-nuevo-iPhone-est-m-s-cerca-de-lo-que-pens-s-2964630ba13581faade9c3062206ea6d","property_problema_relacionado":"Capaz baja m√°s el d√≥lar","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-24T15:30:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Con el d√≥lar m√°s bajo, tu nuevo iPhone est√° m√°s cerca de lo que pens√°s"},{"id":"2974630b-a135-8140-9033-c7db11476a4a","name":"No te arriesgues: ten√©s garant√≠a escrita real que te cubre de verdad.","url":"https://www.notion.so/No-te-arriesgues-ten-s-garant-a-escrita-real-que-te-cubre-de-verdad-2974630ba13581409033c7db11476a4a","property_problema_relacionado":"¬øY si no dura?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-25T12:51:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"No te arriesgues: ten√©s garant√≠a escrita real que te cubre de verdad."},{"id":"2974630b-a135-81af-a888-eceff9e83e55","name":"Compr√°s tranquilo: si falla, volv√©s y lo resolvemos sin vueltas.","url":"https://www.notion.so/Compr-s-tranquilo-si-falla-volv-s-y-lo-resolvemos-sin-vueltas-2974630ba13581afa888eceff9e83e55","property_problema_relacionado":"¬øY si no dura?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-25T12:51:00.000-04:00","end":null,"time_zone":null},"property_url":"https://www.canva.com/design/DAG2wMIsGzQ/H6jNLXg1EDF8aMWhLKvCOA/edit?utm_content=DAG2wMIsGzQ&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton","property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Compr√°s tranquilo: si falla, volv√©s y lo resolvemos sin vueltas."},{"id":"2974630b-a135-81c4-94c2-e94abad845a0","name":"Con nuestra garant√≠a firmada, tu iPhone est√° cubierto desde el primer d√≠a.","url":"https://www.notion.so/Con-nuestra-garant-a-firmada-tu-iPhone-est-cubierto-desde-el-primer-d-a-2974630ba13581c494c2e94abad845a0","property_problema_relacionado":"¬øY si no dura?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-25T12:51:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Con nuestra garant√≠a firmada, tu iPhone est√° cubierto desde el primer d√≠a."},{"id":"29a4630b-a135-8152-8f6b-ef0ab4dd37d9","name":"Hoy ten√©s promo en iPhone, ma√±ana capaz tambi√©n‚Ä¶ si queda alguno para vos.","url":"https://www.notion.so/Hoy-ten-s-promo-en-iPhone-ma-ana-capaz-tambi-n-si-queda-alguno-para-vos-29a4630ba13581528f6bef0ab4dd37d9","property_problema_relacionado":"¬øY si justo lo bajan?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-28T19:36:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Hoy ten√©s promo en iPhone, ma√±ana capaz tambi√©n‚Ä¶ si queda alguno para vos."},{"id":"29a4630b-a135-8155-bf25-d26d0c6ae7ac","name":"Est√°s a un mensaje de tener tu iPhone en promo. Despu√©s no digas que no avisamos.","url":"https://www.notion.so/Est-s-a-un-mensaje-de-tener-tu-iPhone-en-promo-Despu-s-no-digas-que-no-avisamos-29a4630ba1358155bf25d26d0c6ae7ac","property_problema_relacionado":"¬øY si justo lo bajan?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-28T19:36:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Est√°s a un mensaje de tener tu iPhone en promo. Despu√©s no digas que no avisamos."},{"id":"29a4630b-a135-81fb-a4e5-ff1b7280d5df","name":"Si ma√±ana quer√©s uno, capaz ya no haya. Aprovech√° hoy y asegur√° tu iPhone.","url":"https://www.notion.so/Si-ma-ana-quer-s-uno-capaz-ya-no-haya-Aprovech-hoy-y-asegur-tu-iPhone-29a4630ba13581fba4e5ff1b7280d5df","property_problema_relacionado":"¬øY si justo lo bajan?","property_estado":"generado","property_fecha_de_creaci_n":{"start":"2025-10-28T19:36:00.000-04:00","end":null,"time_zone":null},"property_url":null,"property_accion":"GENERAR_CONTENIDOS","property_fecha_publicacion":null,"property_nombre":"Si ma√±ana quer√©s uno, capaz ya no haya. Aprovech√° hoy y asegur√° tu iPhone."}];

  const POR_CREAR = new Set(["generado"]);
  const LISTO = new Set(["listo"]);

  function estado(it){ return (it.property_estado || "").toLowerCase().trim(); }
  function title(it){ return it.property_nombre || it.name || "Sin t√≠tulo"; }
  function problema(it){ return it.property_problema_relacionado || ""; }
  function pubDate(it){
    const v = it.property_fecha_publicacion;
    if(!v) return null;
    if(typeof v === "string") return v;
    return v.start || null;
  }
  function created(it){ return it.property_fecha_de_creaci_n?.start || null; }

  // intenta varios nombres comunes (por si despu√©s agreg√°s guion)
  function script(it){
    return it.property_script
      || it.property_guion
      || it.property_texto
      || it.script
      || it.guion
      || "";
  }

  function fmt(iso){
    if(!iso) return "Sin fecha";
    const d = new Date(iso);
    if(Number.isNaN(d.getTime())) return iso;
    return d.toLocaleString("es-AR", { year:"numeric", month:"2-digit", day:"2-digit", hour:"2-digit", minute:"2-digit" });
  }
  function fmtDay(iso){
    const d = new Date(iso);
    if(Number.isNaN(d.getTime())) return null;
    return d.toLocaleDateString("es-AR", { year:"numeric", month:"2-digit", day:"2-digit" });
  }

  // Modal
  const modalBg = document.getElementById("modalBg");
  const mClose = document.getElementById("mClose");
  const notionFrame = document.getElementById("notionFrame");

  const mTabDetalle = document.getElementById("mTabDetalle");
  const mTabNotion = document.getElementById("mTabNotion");
  const panelDetalle = document.getElementById("panelDetalle");
  const panelNotion = document.getElementById("panelNotion");

  function setModalTab(which){
    [mTabDetalle, mTabNotion].forEach(b => b.classList.remove("active"));
    if(which === "detalle"){
      mTabDetalle.classList.add("active");
      panelDetalle.style.display = "block";
      panelNotion.style.display = "none";
    } else {
      mTabNotion.classList.add("active");
      panelDetalle.style.display = "none";
      panelNotion.style.display = "block";
    }
  }

  mTabDetalle.onclick = () => setModalTab("detalle");
  mTabNotion.onclick = () => setModalTab("notion");

  function openModal(it){
    document.getElementById("mTitle").textContent = title(it);

    const e = estado(it) || "‚Äî";
    document.getElementById("mEstado").textContent =
      POR_CREAR.has(e) ? "Por crear (generado)" : (LISTO.has(e) ? "Listo" : e);

    document.getElementById("mProblema").textContent = problema(it) || "‚Äî";
    document.getElementById("mCreado").textContent = fmt(created(it));
    document.getElementById("mPub").textContent = pubDate(it) ? fmt(pubDate(it)) : "‚Äî";
    document.getElementById("mAccion").textContent = it.property_accion || "‚Äî";

    const links = [];
    if(it.url) links.push(`<a href="${it.url}" target="_blank" rel="noreferrer">Notion</a>`);
    if(it.property_url) links.push(`<a href="${it.property_url}" target="_blank" rel="noreferrer">Canva</a>`);
    document.getElementById("mLinks").innerHTML = links.length ? links.join(" ¬∑ ") : "‚Äî";

    const s = script(it);
    document.getElementById("mScript").textContent = s ? s : "‚Äî (no hay script/guion en este item todav√≠a)";
    document.getElementById("mJson").textContent = JSON.stringify(it, null, 2);

    // cargar notion iframe
    if(it.url){
      notionFrame.src = it.url;
    } else {
      notionFrame.src = "about:blank";
    }

    // abrir en detalle por defecto
    setModalTab("detalle");
    modalBg.style.display = "flex";
  }
  function closeModal(){ modalBg.style.display = "none"; }

  mClose.onclick = closeModal;
  modalBg.onclick = (e) => { if(e.target === modalBg) closeModal(); };
  window.addEventListener("keydown", (e) => { if(e.key === "Escape") closeModal(); });

  // UI
  let mode = "por-crear";

  const elTotal = document.getElementById("total");
  const elPorCrear = document.getElementById("porCrear");
  const elListo = document.getElementById("listo");
  const elEnCal = document.getElementById("enCal");
  const elList = document.getElementById("list");
  const elFoot = document.getElementById("foot");
  const elQ = document.getElementById("q");

  const tabPorCrear = document.getElementById("tabPorCrear");
  const tabListo = document.getElementById("tabListo");
  const tabTodos = document.getElementById("tabTodos");

  function setActive(){
    [tabPorCrear, tabListo, tabTodos].forEach(b => b.classList.remove("active"));
    if(mode==="por-crear") tabPorCrear.classList.add("active");
    if(mode==="listo") tabListo.classList.add("active");
    if(mode==="todos") tabTodos.classList.add("active");
  }

  function renderList(view){
    elList.innerHTML = view.slice(0, 120).map((i) => {
      const t = title(i);
      const e = estado(i) || "‚Äî";
      const prob = problema(i);
      const fPub = pubDate(i);
      const fCre = created(i);

      const notion = i.url || "";
      const canva = i.property_url || "";

      const chip = POR_CREAR.has(e) ? "Por crear" : (LISTO.has(e) ? "Listo" : e);

      return `
        <div class="item" data-id="${i.id}">
          <div style="min-width:0">
            <div class="title" title="${t.replaceAll('"','&quot;')}">${t}</div>
            <div class="meta">
              <span class="chip">${chip}</span>
              ${prob ? ` <span class="chip">Problema: ${prob}</span>` : "" }
              ${fPub ? ` <span class="chip">Publicaci√≥n: ${fmt(fPub)}</span>` : "" }
            </div>
          </div>
          <div class="right">
            <div class="meta">Creado: ${fmt(fCre)}</div>
            <div>
              ${notion ? `<a href="${notion}" target="_blank" rel="noreferrer" onclick="event.stopPropagation()">Notion</a>` : "" }
              ${canva ? ` ¬∑ <a href="${canva}" target="_blank" rel="noreferrer" onclick="event.stopPropagation()">Canva</a>` : "" }
            </div>
          </div>
        </div>
      `;
    }).join("");

    elList.querySelectorAll(".item").forEach(el => {
      el.addEventListener("click", () => {
        const id = el.getAttribute("data-id");
        const it = ITEMS.find(x => x.id === id);
        if(it) openModal(it);
      });
    });
  }

  function renderCalendar(){
    const calWrap = document.getElementById("calendarWrap");
    const calSub = document.getElementById("calSub");

    const enCal = ITEMS.filter(i => !!pubDate(i));
    calSub.textContent = enCal.length
      ? `${enCal.length} publicaciones con fecha cargada.`
      : "Todav√≠a no hay fechas de publicaci√≥n cargadas en Notion (property_fecha_publicacion).";

    if(enCal.length === 0){
      calWrap.innerHTML = '<div class="muted" style="margin-top:10px;">Calendario vac√≠o por ahora.</div>';
      return;
    }

    const map = new Map();
    enCal.forEach(i => {
      const d = fmtDay(pubDate(i));
      if(!d) return;
      if(!map.has(d)) map.set(d, []);
      map.get(d).push(i);
    });

    const days = Array.from(map.keys()).sort((a,b)=> a.localeCompare(b));

    calWrap.innerHTML = `
      <div class="cal">
        ${days.map(day => {
          const evs = map.get(day).slice().sort((a,b)=> (pubDate(a)||"").localeCompare(pubDate(b)||""));
          const eventsHtml = evs.map(i => {
            const t = title(i);
            return `<div class="ev" data-id="${i.id}" title="${t.replaceAll('"','&quot;')}">${t}</div>`;
          }).join("");

          return `
            <div class="day">
              <h3>${day}</h3>
              ${eventsHtml}
            </div>
          `;
        }).join("")}
      </div>
    `;

    calWrap.querySelectorAll(".ev").forEach(el => {
      el.addEventListener("click", () => {
        const id = el.getAttribute("data-id");
        const it = ITEMS.find(x => x.id === id);
        if(it) openModal(it);
      });
    });
  }

  function render(){
    const q = (elQ.value || "").toLowerCase().trim();

    const porCrear = ITEMS.filter(i => POR_CREAR.has(estado(i)));
    const listo = ITEMS.filter(i => LISTO.has(estado(i)));
    const enCal = ITEMS.filter(i => !!pubDate(i));

    elTotal.textContent = ITEMS.length;
    elPorCrear.textContent = porCrear.length;
    elListo.textContent = listo.length;
    elEnCal.textContent = enCal.length;

    let view = ITEMS;
    if(mode==="por-crear") view = porCrear;
    if(mode==="listo") view = listo;
    if(mode==="todos") view = ITEMS;

    if(q){
      view = view.filter(i =>
        title(i).toLowerCase().includes(q) ||
        (problema(i)||"").toLowerCase().includes(q)
      );
    }

    view = view.slice().sort((a,b)=> ((created(a)||"").localeCompare(created(b)||"")));
    renderList(view);

    elFoot.textContent = `Mostrando ${Math.min(120, view.length)} de ${view.length} (${mode}). Toc√° un item para ver el detalle.`;

    renderCalendar();
  }

  tabPorCrear.onclick = () => { mode="por-crear"; setActive(); render(); };
  tabListo.onclick = () => { mode="listo"; setActive(); render(); };
  tabTodos.onclick = () => { mode="todos"; setActive(); render(); };
  document.getElementById("refresh").onclick = () => location.reload();
  elQ.oninput = render;

  setActive();
  render();
</script>
</body>
</html>