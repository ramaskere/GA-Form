<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>GO APPLE â€” Formulario</title>

<!-- âœ… Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init','650415544428771'); fbq('track','PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=650415544428771&ev=PageView&noscript=1"/></noscript>
<!-- âœ… End Meta Pixel Code -->

<style>
  :root{ --bg:#ffffff; --surface:#ffffff; --line:#e6e6e9; --ink:#1d1d1f; --muted:#6e6e73; --accent:#0071e3; --radius:16px; }
  *{box-sizing:border-box} html,body{height:100%}
  body{ margin:0; background:linear-gradient(180deg,#f7f8fb,#eef1f6); color:var(--ink);
        font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",Segoe UI,Roboto,Helvetica,Arial,sans-serif;
        display:grid; place-items:center; padding:18px; }
  .card{ width:min(640px,94vw); background:var(--surface); border:1px solid var(--line); border-radius:var(--radius);
         box-shadow:0 20px 60px rgba(0,0,0,.10); overflow:hidden; }
  header{ padding:20px 22px 0; text-align:center; }
  h1{ margin:0; font-size:24px; font-weight:800; } 
  p.lead{ margin:8px 0 16px; color:#424245; font-size:15px; }
  .form-body{ padding:18px; display:grid; gap:14px; } .row{ display:grid; gap:10px; }
  label{ font-size:13px; color:#424245; font-weight:600; }
  input,select{ width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--line); background:#fafafa; font-size:14px; outline:none; }
  input[type="email"]:invalid{ border-color:#ffb4b4; }
  .actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:4px; }
  .btn{ appearance:none; padding:11px 16px; border-radius:999px; font-weight:700; cursor:pointer; border:1px solid #cfd2d8; background:#fff; }
  .btn.primary{ background:var(--accent); color:#fff; border-color:var(--accent); } .btn:hover{ filter:brightness(.98); }
  .hidden{ display:none !important; } 
  footer.note{ padding:0 18px 18px; color:#6e6e73; font-size:12.5px; text-align:center; }

  /* Mensaje final (cuando elijan "< 300k") */
  .final-wrap{ padding:26px 22px 28px; text-align:center; }
  .final-emoji{ font-size:42px; }
  .final-title{ margin:10px 0 6px; font-size:22px; font-weight:800; }
  .final-text{ margin:0 auto; max-width:520px; color:#424245; font-size:15px; line-height:1.45; }
  .final-badge{ display:inline-block; margin-top:14px; padding:6px 12px; border-radius:999px; background:#eff6ff; color:#1e40af; font-weight:700; font-size:12.5px; border:1px solid #dbeafe; }
  .final-ok{ margin-top:16px; padding:10px 16px; border-radius:999px; border:1px solid #cfd2d8; background:#fff; font-weight:700; cursor:default; color:#1d1d1f; }
</style>
</head>
<body>
<main class="card" role="dialog" aria-modal="true" aria-labelledby="form-title">
  <header id="hdr">
    <h1 id="form-title">ðŸ”¥ GanÃ¡ 10% de Descuento ðŸ”¥</h1>
    <p class="lead" id="form-lead">CompletÃ¡ el formulario y accedÃ© a un <strong>10% OFF</strong> en tu prÃ³ximo iPhone.</p>
  </header>

  <!-- âœ… Agregado id="leadForm" -->
  <form id="leadForm">
  <section class="form-body" id="form-body">
    <!-- Paso 1 -->
    <div id="step1" class="row">
      <div>
        <label for="lf-name">Nombre</label>
        <input id="lf-name" name="nombre" type="text" placeholder="Tu nombre" autocomplete="name" />
      </div>
      <div>
        <label for="lf-email">Correo</label>
        <input id="lf-email" name="correo" type="email" placeholder="tu@email.com" autocomplete="email" required />
      </div>
      <div>
        <label for="lf-phone">WhatsApp</label>
        <input id="lf-phone" name="telefono" type="tel" placeholder="+54 9 ..." inputmode="tel" autocomplete="tel" />
      </div>
      <div class="actions">
        <button type="button" class="btn" id="cancel">Cancelar</button>
        <button type="button" class="btn primary" id="next">Continuar</button>
      </div>
    </div>

    <!-- Paso 2 -->
    <div id="step2" class="row hidden">
      <div>
        <label for="lf-budget">Â¿CuÃ¡l es tu inversiÃ³n (ARS)?</label>
        <select id="lf-budget" name="presupuesto">
          <option value="menos">Menos de $300.000</option>
          <option value="400-600">$400.000 a $600.000</option>
          <option value="700-900">$700.000 a $900.000</option>
          <option value="mas900">MÃ¡s de $900.000</option>
        </select>
      </div>
      <div class="actions">
        <button type="button" class="btn" id="back">Volver</button>
        <button type="submit" class="btn primary" id="send">Enviar</button>
      </div>
    </div>
  </section>
  </form>

  <footer class="note" id="note">Completando el formulario obtenÃ©s tu beneficio del 10% OFF.</footer>
</main>

<!-- Script principal (validaciÃ³n, webhook, pixel, whatsapp) -->
<script>
(function(){
  // ... (todo tu cÃ³digo JS previo sin cambios)
})();
</script>

<!-- âœ… Script adicional para Apps Script -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('leadForm');
  if (!form) return;

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const fd = new FormData(form);
    const payload = {
      nombre:      fd.get('nombre')      || '',
      telefono:    fd.get('telefono')    || '',
      presupuesto: fd.get('presupuesto') || '',
      modelo:      fd.get('modelo')      || '',
      ciudad:      fd.get('ciudad')      || '',
      pais:        fd.get('pais')        || '',
      califica:    fd.get('califica')    || '',
      origen:      'goapple-form'
    };

    try {
      const WEBHOOK = 'https://script.google.com/macros/s/XXXXXXXX/exec';

      await fetch(WEBHOOK, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      alert('Â¡Listo! Registramos tus datos âœ…');
      form.reset();
    } catch (err) {
      console.error(err);
      alert('No pudimos enviar el formulario. Intenta de nuevo.');
    }
  });
});
</script>
</body>
</html>